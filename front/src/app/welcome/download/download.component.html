<div class="max-content">

  <mat-card>
    <div *ngIf="!order">
      <mat-card-title>GeoShop - Téléchargement</mat-card-title>
      <mat-card-content>
        <mat-spinner class="flex" diameter="48" color="accent" style="margin-right: 10px"></mat-spinner>
      </mat-card-content>
    </div>

    <div *ngIf="order">

      <mat-card-title>N°{{order.id}} - {{order.title}}</mat-card-title>
      <mat-card-subtitle>
        Commande du {{order.date_ordered | date}}.<span class="text-ellipsis-2">{{order.description}}</span>
      </mat-card-subtitle>
      <mat-card-content>
        <div *ngIf="order && order.status === 'PROCESSED'" class="mb-2">
          <div class="flex">
            <button mat-raised-button color="primary" class="action-button" (click)="downloadOrder($event)">
              <mat-icon>download</mat-icon> Télécharger les données
            </button>
          </div>
        </div>
        <div *ngIf="order?.status !== 'PROCESSED'">
          <p>Votre commande n'est plus disponible.</p>
          <p>Les liens de téléchargement ne sont valables que pendant un mois. <br>
            N'hésitez pas à nous contacter si vous souhaitez une nouvelle extraction.</p>
        </div>
        <gs2-order-item-view [order]="order" [dataSource]="order.items" [showAction]="false"></gs2-order-item-view>
        <div class="mini-map" [id]="'mini-map-' + order.id"></div>
      </mat-card-content>
    </div>
  </mat-card>

</div>